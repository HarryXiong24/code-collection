// ç®¡é“çš„é˜»å¡
// å½“è¿™ä¸ªç®¡é“åªå†™å…¥æ•°æ®ï¼Œä¸è¯»ï¼Œå°±ä¼šå‘ç”Ÿé˜»å¡
// é˜»å¡å‘ç”Ÿçš„åŸå› åœ¨äº Go ä¸­çš„é€šé“ï¼ˆchannelï¼‰åœ¨æ²¡æœ‰æ•°æ®å¯è¯»å–æˆ–è€…æ— æ³•å‘é€æ•°æ®æ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šè®© Goroutine è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œå¯¼è‡´ä»£ç æš‚åœæ‰§è¡Œï¼Œç›´åˆ°æ¡ä»¶æ»¡è¶³ä¸ºæ­¢ã€‚è¿™ç§è¡Œä¸ºç§°ä¸º é˜»å¡ã€‚

// å†™çš„å¿«ï¼Œè¯»çš„æ…¢ï¼Œä¸ä¼šå‘ç”Ÿé˜»å¡

package main

import (
	"fmt"
	"sync"
)

func read(intChan chan int) {
	defer wg.Done()
	for value := range intChan {
		fmt.Println("The read data is: ", value)
	}
}

func write(intChan chan int) {
	defer wg.Done()
	for i := 1; i <= 50; i++ {
		intChan <- i
		fmt.Println("The write data is: ", i)
	}

	close(intChan)
}

var wg sync.WaitGroup

func main() {
	intChan := make(chan int, 50)

	// å¼€å¯è¯»å’Œå†™çš„åç¨‹
	wg.Add(2)
	go write(intChan)
	go read(intChan)

	wg.Wait()
}

// åœ¨ Go è¯­è¨€ä¸­ï¼Œ**é€šé“ï¼ˆchannelï¼‰ä¼šé˜»å¡**ï¼Œä½†æ˜¯å¦é˜»å¡å–å†³äºé€šé“çš„**ç±»å‹ï¼ˆæ— ç¼“å†² or æœ‰ç¼“å†²ï¼‰**ä»¥åŠ**è¯»å†™é€Ÿåº¦**ã€‚

// ---

// ## **1. æ— ç¼“å†²é€šé“ï¼ˆUnbuffered Channelï¼‰**
// ### **å†™å…¥æ“ä½œä¼šé˜»å¡ï¼Œç›´åˆ°æœ‰ Goroutine è¯»å–**
// ```go
// package main

// import "fmt"

// func main() {
//     ch := make(chan int) // æ— ç¼“å†²é€šé“

//     go func() {
//         ch <- 10 // è¿™é‡Œä¼šé˜»å¡ï¼Œç›´åˆ° main åç¨‹è¯»å–æ•°æ®
//         fmt.Println("Sent 10")
//     }()

//     fmt.Println(<-ch) // è¯»å–æ•°æ®ï¼Œè§£é™¤é˜»å¡
//     fmt.Println("Done")
// }
// ```
// ### **æ‰§è¡Œç»“æœ**
// ```
// 10
// Sent 10
// Done
// ```
// ### **è§£é‡Š**
// - **å†™å…¥ `ch <- 10` æ—¶ï¼Œè‹¥æ²¡æœ‰å…¶ä»–åç¨‹è¯»å–æ•°æ®ï¼Œå†™å…¥æ“ä½œä¼šé˜»å¡ã€‚**
// - **`<-ch` è¯»å–æ•°æ®åï¼Œå†™å…¥æ‰å®Œæˆã€‚**
// - **æ— ç¼“å†²é€šé“** å¼ºåˆ¶å‘é€æ–¹å’Œæ¥æ”¶æ–¹åœ¨**åŒä¸€æ—¶åˆ»è¿›è¡Œæ•°æ®äº¤äº’**ã€‚

// ### **âœ… ç»“è®ºï¼šæ— ç¼“å†²é€šé“å†™å…¥æ—¶å¿…é¡»æœ‰äººè¯»å–ï¼Œå¦åˆ™ä¼šé˜»å¡ã€‚**

// ---

// ## **2. æœ‰ç¼“å†²é€šé“ï¼ˆBuffered Channelï¼‰**
// ### **å†™å…¥ä¸ä¼šç«‹å³é˜»å¡ï¼Œç›´åˆ°ç¼“å†²åŒºæ»¡**
// ```go
// package main

// import (
//     "fmt"
//     "time"
// )

// func main() {
//     ch := make(chan int, 3) // æœ‰ç¼“å†²é€šé“ï¼Œå®¹é‡ä¸º3

//     go func() {
//         ch <- 1
//         fmt.Println("Sent 1")
//         ch <- 2
//         fmt.Println("Sent 2")
//         ch <- 3
//         fmt.Println("Sent 3")
//         ch <- 4 // é˜»å¡ï¼Œå› ä¸ºç¼“å†²åŒºå·²æ»¡
//         fmt.Println("Sent 4")
//     }()

//     time.Sleep(time.Second * 2) // å»¶è¿Ÿè¯»å–æ•°æ®
//     fmt.Println("Received:", <-ch)
//     fmt.Println("Received:", <-ch)
//     fmt.Println("Received:", <-ch)
//     fmt.Println("Received:", <-ch) // è§£é™¤é˜»å¡
// }
// ```
// ### **å¯èƒ½çš„è¾“å‡º**
// ```
// Sent 1
// Sent 2
// Sent 3
// Received: 1
// Sent 4
// Received: 2
// Received: 3
// Received: 4
// ```
// ### **è§£é‡Š**
// - `ch <- 1, 2, 3` **ä¸ä¼šé˜»å¡**ï¼Œå› ä¸ºç¼“å†²åŒºæœ‰ 3 ä¸ªç©ºä½ã€‚
// - `ch <- 4` **ä¼šé˜»å¡**ï¼Œå› ä¸ºç¼“å†²åŒºå·²æ»¡ï¼Œå¿…é¡»ç­‰ `<-ch` è¯»å–æ•°æ®åæ‰ä¼šç»§ç»­æ‰§è¡Œã€‚
// - å½“ `<-ch` è¯»å–æ•°æ®ï¼Œç¼“å†²åŒºç©ºå‡ºä½ç½®ï¼Œ`ch <- 4` æ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚

// ### **âœ… ç»“è®ºï¼š**
// - **æœ‰ç¼“å†²é€šé“** å…è®¸å†™å…¥**ä¸é˜»å¡**ï¼Œåªè¦ç¼“å†²åŒº**æœªæ»¡**ã€‚
// - **å½“ç¼“å†²åŒºæ»¡æ—¶ï¼Œå†™å…¥é˜»å¡ï¼Œç›´åˆ°æœ‰åç¨‹è¯»å–æ•°æ®ã€‚**

// ---

// ## **3. å†™å…¥å¿«ï¼Œè¯»å–æ…¢ï¼Œä¸ä¼šå‘ç”Ÿé˜»å¡ï¼Ÿ**
// ä½ æåˆ°çš„ã€Œ**å†™çš„å¿«ï¼Œè¯»çš„æ…¢ï¼Œä¸ä¼šå‘ç”Ÿé˜»å¡**ã€ï¼Œ**å‰ææ˜¯æœ‰è¶³å¤Ÿå¤§çš„ç¼“å†²åŒº**ã€‚

// ```go
// package main

// import (
// 	"fmt"
// 	"time"
// )

// func main() {
// 	ch := make(chan int, 100) // 100ä¸ªç¼“å†²

// 	// å†™å…¥æ•°æ®ï¼ˆç”Ÿäº§è€…ï¼‰
// 	go func() {
// 		for i := 1; i <= 100; i++ {
// 			ch <- i
// 			fmt.Println("Sent:", i)
// 			time.Sleep(time.Millisecond * 10) // å†™å…¥é—´éš”çŸ­
// 		}
// 		close(ch) // å…³é—­é€šé“
// 	}()

// 	// è¯»å–æ•°æ®ï¼ˆæ¶ˆè´¹è€…ï¼‰
// 	go func() {
// 		time.Sleep(time.Second * 2) // è¯»å–å»¶è¿Ÿ
// 		for val := range ch {
// 			fmt.Println("Received:", val)
// 			time.Sleep(time.Millisecond * 500) // è¯»å–é—´éš”é•¿
// 		}
// 	}()

// 	time.Sleep(time.Second * 20) // ç­‰å¾…æ‰€æœ‰ goroutine å®Œæˆ
// }
// ```

// ### **æ‰§è¡Œç»“æœ**
// - ç”±äº `ch` çš„ç¼“å†²åŒºå¾ˆå¤§ï¼Œç”Ÿäº§è€… `ch <- i` **å¯ä»¥ä¸€ç›´å†™å…¥æ•°æ®ï¼Œè€Œä¸ä¼šé˜»å¡**ï¼Œç›´åˆ°ç¼“å†²åŒºæ»¡ã€‚
// - è¯»å–æ•°æ®æ—¶ï¼Œå³ä½¿æ¯”å†™å…¥æ…¢ï¼Œä¹Ÿä¸ä¼šå½±å“å†™å…¥ï¼Œé™¤éç¼“å†²åŒºæ»¡ã€‚

// ### **âœ… ç»“è®º**
// - **å†™å…¥é€Ÿåº¦å¿«ï¼Œè¯»å–é€Ÿåº¦æ…¢**ï¼Œå¦‚æœ**ç¼“å†²åŒºè¶³å¤Ÿå¤§**ï¼Œé‚£ä¹ˆ**ä¸ä¼šå‘ç”Ÿé˜»å¡**ã€‚
// - **å½“ç¼“å†²åŒºæ»¡æ—¶ï¼Œå†™å…¥æ“ä½œæ‰ä¼šé˜»å¡ï¼Œç›´åˆ°æœ‰æ•°æ®è¢«æ¶ˆè´¹ã€‚**

// ---

// ## **4. ä»€ä¹ˆæ—¶å€™ä¼šå‘ç”Ÿé˜»å¡ï¼Ÿ**
// | **é€šé“ç±»å‹**       | **å†™å…¥æ—¶æ˜¯å¦ä¼šé˜»å¡ï¼Ÿ**                                |
// |------------------|--------------------------------|
// | **æ— ç¼“å†²é€šé“** (`make(chan int)`) | âœ… **é˜»å¡**ï¼ˆå¿…é¡»æœ‰è¯»å–æ–¹ï¼Œå¦åˆ™å†™å…¥ä¼šé˜»å¡ï¼‰ |
// | **æœ‰ç¼“å†²é€šé“** (`make(chan int, N)`) | âŒ ä¸é˜»å¡ï¼ˆç¼“å†²æœªæ»¡ï¼‰ âœ… é˜»å¡ï¼ˆç¼“å†²åŒºæ»¡ï¼‰ |
// | **å†™çš„å¿«ï¼Œè¯»çš„æ…¢** | âœ… å¯èƒ½é˜»å¡ï¼ˆå¦‚æœç¼“å†²åŒºæ»¡ï¼‰ âŒ ä¸é˜»å¡ï¼ˆå¦‚æœç¼“å†²åŒºå¤Ÿå¤§ï¼‰ |

// ---

// ## **5. æ€»ç»“**
// 1. **æ— ç¼“å†²é€šé“ `make(chan T)`**
//    - å‘é€å’Œæ¥æ”¶å¿…é¡»**åŒæ­¥**ï¼Œå¦åˆ™å†™å…¥æ“ä½œä¼šé˜»å¡ã€‚
//    - å‘é€æ“ä½œ `ch <- x` **å¿…é¡»ç­‰åˆ°æ¥æ”¶æ–¹ `<-ch` è¯»å–åæ‰èƒ½ç»§ç»­**ã€‚

// 2. **æœ‰ç¼“å†²é€šé“ `make(chan T, N)`**
//    - å†™å…¥ä¸ä¼šé˜»å¡ï¼Œ**åªè¦ç¼“å†²åŒºæœªæ»¡**ã€‚
//    - å¦‚æœç¼“å†²åŒº**å†™æ»¡åï¼Œå†™å…¥ä¼šé˜»å¡**ï¼Œç›´åˆ°æœ‰è¯»å–æ“ä½œã€‚

// 3. **å†™çš„å¿«ï¼Œè¯»çš„æ…¢**
//    - **ä¸ä¼šé˜»å¡**ï¼Œå¦‚æœ**ç¼“å†²åŒºè¶³å¤Ÿå¤§**ï¼Œå¯ä»¥æš‚å­˜æœªæ¶ˆè´¹çš„æ•°æ®ã€‚
//    - **ä¼šé˜»å¡**ï¼Œå¦‚æœ**ç¼“å†²åŒºæ»¡**ï¼Œå†™å…¥å¿…é¡»ç­‰åˆ°æ•°æ®è¢«æ¶ˆè´¹ã€‚

// ### **ğŸš€ å¦‚ä½•é¿å…é˜»å¡**
// âœ… **ä½¿ç”¨åˆé€‚å¤§å°çš„ç¼“å†²åŒº**
// âœ… **ä½¿ç”¨ goroutine è¯»å–æ•°æ®**
// âœ… **ç¡®ä¿å†™å…¥æ–¹å’Œè¯»å–æ–¹çš„æ‰§è¡Œé€Ÿç‡åŒ¹é…**
// âœ… **å¦‚æœä¸ç¡®å®šé€Ÿç‡ï¼Œå¯ä»¥ select + default é¿å…é˜»å¡**
// ```go
// select {
// case ch <- value:
//     fmt.Println("Sent:", value)
// default:
//     fmt.Println("Channel is full, skipping...")
// }
// ```
// è¿™æ ·å†™å…¥ä¸ä¼šé˜»å¡ï¼Œè€Œæ˜¯è·³è¿‡å†™å…¥ï¼Œé¿å… goroutine æŒ‚èµ·ã€‚

// ---
// **ğŸ“Œ ç»“è®ºï¼šåœ¨ Go è¯­è¨€ä¸­ï¼Œå†™çš„å¿«ã€è¯»çš„æ…¢ä¸ä¼šé˜»å¡çš„å‰ææ˜¯**ã€Œ**ç¼“å†²åŒºè¶³å¤Ÿå¤§**ã€ã€‚ä½†å¦‚æœç¼“å†²åŒºæ»¡äº†ï¼Œ**å†™å…¥æ“ä½œä¼šé˜»å¡**ï¼Œç­‰å¾…æ•°æ®è¢«æ¶ˆè´¹ã€‚
